# 内存模型

内存模型的目的是为了定义清楚变量的读写在不同执行体里的可见性。理解内存模型在并发编程中非常重要，因为代码的执行顺序和书写的逻辑顺序并不会完全一致，甚至在编译期间编译器也有可能重排代码以最优化CPU执行, 另外还因为有CPU缓存的存在，内存的数据不一定会及时更新，这样对内存中的同一个变量读和写也不一定和期望一样。

## Happens Before
在一个单独的Goroutine里，对变量的读写和代码的书写顺序一致

Happens-before用来指明Go程序里的内存操作的局部顺序。如果一个内存操作事件e1 happens-before e2，则e2 happens-after e1也成立；
如果e1不是happens-before e2,也不是happens-after e2，则e1和e2是并发的。


## Golang中变量的分配位置是堆or栈

Go 编译器自行决定变量分配在堆栈或堆上，以保证程序的正确性。

如果一个变量的地址被调用了，这个变量将会候选分配在堆上。然而，一个基本转义分析会识别一些情况。在这些情况里，变量不会存活到函数返回，这些变量将分配到栈上。
